[["ggplot.html", "Chapter 10 SPC Charts with ggplot2", " Chapter 10 SPC Charts with ggplot2 Armed with the battery of functions from Chapter 9 we are able to construct any of the Magnificent Eight using only functionality from base R. d &lt;- read.csv(&#39;data/cdiff.csv&#39;, comment.char = &#39;#&#39;, colClasses = c(month = &#39;Date&#39;)) p &lt;- spc(month, infections, data = d, chart = &#39;c&#39;, main = &#39;CDiff infections&#39;, ylab = &#39;Count&#39;, xlab = &#39;Month&#39;, plot = FALSE) head(p) ## x y n lcl cl ucl sigma.signal runs.signal chart ## 1 2020-01-01 12 1 0 5.041667 11.77776 TRUE TRUE c ## 2 2020-02-01 7 1 0 5.041667 11.77776 FALSE TRUE c ## 3 2020-03-01 1 1 0 5.041667 11.77776 FALSE TRUE c ## 4 2020-04-01 4 1 0 5.041667 11.77776 FALSE TRUE c ## 5 2020-05-01 4 1 0 5.041667 11.77776 FALSE TRUE c ## 6 2020-06-01 5 1 0 5.041667 11.77776 FALSE TRUE c plot(p) library(ggplot2) ggspc &lt;- function(p) { col1 &lt;- &#39;steelblue&#39; col2 &lt;- &#39;tomato&#39; dotcol &lt;- ifelse(p$sigma.signal, col2, col1) clcol &lt;- ifelse(p$runs.signal[1], col2, col1) cltyp &lt;- ifelse(p$runs.signal[1], &#39;dashed&#39;, &#39;solid&#39;) ggplot(p, aes(x, y)) + geom_line(aes(y = lcl), na.rm = TRUE) + geom_line(aes(y = ucl), na.rm = TRUE) + geom_line(aes(y = cl), na.rm = T, colour = clcol, linetype = cltyp) + geom_line(colour = col1, na.rm = TRUE) + geom_point(colour = dotcol, na.rm = TRUE) } ggspc(p) p &lt;- ggspc(p) p + theme_light() + theme(panel.grid = element_blank(), panel.border = element_blank(), axis.line = element_line(colour = &#39;gray&#39;)) + labs(title = &#39;CDiff infections&#39;, y = &#39;Count&#39;, x = &#39;Month&#39;) plot.spc &lt;- ggspc plot(p) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
